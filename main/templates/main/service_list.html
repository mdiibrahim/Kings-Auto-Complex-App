{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Services</title>
<!-- Link to the Favicon -->
    <link rel="icon" href="{% static '/favicon.ico' %}" type="image/x-icon">

    <!-- Include Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" />

    <style>
  :root {
    --primary-color: #eab11a;
    --secondary-color: #f9d448;
    --third-color: #f2f2f2;
    --background-color: #000000;
  }

  /* Body styling with car background image */
  body {
    background: url('{% static "car_image.jpg" %}') no-repeat center center fixed;
    background-size: cover; /* Ensure the image covers the entire background */
  }

  /* Container for the main content */
  .container {
    background-color: rgba(255, 255, 255, 0.7); /* Make background a little transparent */
    padding: 50px;
    border-radius: 10px;
    margin-top: 100px; /* Add some top margin */
    margin-bottom: 100px; /* Add some top margin */
    max-width: 75% !important;

  margin-left: auto; /* Center horizontally */
  margin-right: auto; /* Center horizontally */
  }

  /* Table styling */
  table {
    margin-top: 20px;

  }

  /* Header Styling */
  .table th {
    background-color: var(--primary-color);
  }

  /* Darker text for table rows */
  tr td {
    color: #333 !important; /* Darker text color */
     font-weight: 500;
  }

  /* Confirm Delete Popup */
  .modal-body {
    font-size: 1rem;
    color: black;
  }

  /* Edit Button Styling (Login Style) */
  .btn-login {
    background-color: var(--primary-color) !important; /* Primary color as default */
    color: #000;
    font-weight: 700;
    border-radius: 50px;
    padding: 15px;
    transition: background-color 0.3s, transform 0.3s ease;
    margin: 0 auto;
    display: flex;
    justify-content: center;
  }

  .btn-login:hover {
    background-color: var(--secondary-color) !important; /* Secondary color on hover */
    transform: scale(1.05);
  }
</style>

  </head>

  <body>
    {% include 'main/navbar.html' %}

    <div class="container">
      <h3 class="text-center">Services</h3>
      <table class="table table-bordered text-center">
        <thead style="background-color: var(--primary-color);">
          <tr>
            <th>Service ID</th>
            <th>Service Name</th>
            <th>Service Charge</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for service in services %}
          <tr>
            <td>{{ service.service_id }}</td>
            <td>{{ service.service_name }}</td>
            <td>{{ service.service_charge }}</td>
            <td>
              <!-- Edit Button Styled as Login Button -->
              <a href="{% url 'edit_service' service.service_id %}" class="btn btn-login">Edit</a>

              <!-- Delete Button with data-id to Trigger Modal -->
              <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal" data-id="{{ service.service_id }}">Delete</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Are you sure you want to delete this service? This action cannot be undone.
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <form id="deleteForm" action="" method="POST" style="display:inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger">Delete</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    {% include 'main/footer.html' %}

    <!-- Bootstrap 5 JS (No jQuery required) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // When the modal is shown, update the form action dynamically with the correct service ID
      var deleteModal = document.getElementById('deleteModal')
      deleteModal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget; // Button that triggered the modal
        var serviceId = button.getAttribute('data-id'); // Extract service ID from the data-id attribute
        var url = "{% url 'delete_service' service_id=0 %}".replace('0', serviceId); // Replace placeholder with actual service ID
        var form = document.getElementById('deleteForm');
        form.setAttribute('action', url); // Set the action URL for the form
      });
    </script>
  </body>
</html>
