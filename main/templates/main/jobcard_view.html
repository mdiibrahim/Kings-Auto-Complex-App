{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>View Jobcard</title>
      <!-- Link to the Favicon -->
    <link rel="icon" href="{% static '/favicon.ico' %}" type="image/x-icon">
    <!-- Include Bootstrap 5 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"/>

    <style>
        :root {
          --primary-color: #eab11a;
          --secondary-color: #f9d448;
          --third-color: #f2f2f2;
          --background-color: #000000;
        }

        /* Body styling with car background image */
        body {
          background: url('{% static "car_image.jpg" %}') no-repeat center center fixed;
          background-size: cover; /* Ensure the image covers the entire background */
        }

        /* Container for the main content */
        .container {
          background-color: rgba(255, 255, 255, 0.9); /* Make background a little transparent */
          padding: 50px;
          border-radius: 10px;
          margin-top: 100px; /* Add some top margin */
          margin-bottom: 100px; /* Add some bottom margin */
          max-width: 75% !important;
          margin-left: auto; /* Center horizontally */
          margin-right: auto; /* Center horizontally */
        }

        .btn-login {
          background-color: var(--primary-color) !important; /* Primary color as default */
          color: #000;
          font-weight: 700;
          border-radius: 50px;
          padding: 15px;
          transition: background-color 0.3s, transform 0.3s ease;
        }

        .btn-login:hover {
          background-color: var(--secondary-color) !important; /* Secondary color on hover */
          transform: scale(1.05);
        }
        .main {
          background-image: url("{% static 'sign.jpg' %}");
          background-size: cover;
          background-repeat: no-repeat;
          background-position: center;
          height: 18vh; /* Adjust the height of the container as needed */
          width: 100%; /* Adjust the width of the container as needed */
          display: flex;
          justify-content: center;
          align-items: center;
        }

          .table th, .table td {

    padding: 10px;
  }
  .table th{
          background-color: var(--primary-color) !important;
          }
/* Adjust layout for printing */
@media print {
  /* Remove the background image when printing */
  body {
    background-color: white !important;
    background-image: none !important;
    margin: 0 !important; /* Remove margins */
    padding: 0 !important; /* Remove padding */
    width: 100% !important;
  }

  /* Ensure container is properly centered and stretches correctly */
  .container {
    margin: 0 !important; /* Remove all margins */
    padding: 15px !important; /* Remove all padding */
    top: 0;
    position: relative;
    max-width: 100% !important;

  }

  /* Hide the print button */
  .print-btn, .navbar-wrapper {
    display: none !important; /* Hide the print button */
  }



  /* Ensure footer takes full width and sticks at the bottom of the last page */
  footer {
    width: 100% !important;
    padding: 15px !important;
    margin: 0 !important;
    position: relative; /* Make sure it's positioned relative to the page */
    bottom: 0;
      page-break-before: auto;
      font-size: small;
  }


 /* Force a page break before the table */
  .page-break-before {
    page-break-before: auto !important;
  }
  .page-break-after {
    page-break-after: auto !important;
  }

  /* Ensure main container (background image) does not add extra margins */
  .main {
    background-image: url("{% static 'sign.jpg' %}");
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    height: 90px; /* Adjust the height for print */
    width: 100%; /* Adjust the width of the container as needed */
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 !important; /* Remove margin for printing */
  }
}

    </style>
</head>
<body>
{% include 'main/navbar.html' %}
<div
        class=" container justify-content-center"
>
    <form id="dynamic-form" action="{% url 'create_jobcard' %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="date1" id="date1">
        <div
                class="" style="border: 1px solid black;">
            <div
                    style="border: 1px solid black;"
                    class="main"
            ></div>
            <div class="text-center my-3">
                <h4><u>Jobcard</u></h4>
            </div>
            <div class="text-center mb-1">
                <h3><strong>Kings Auto Complex</strong></h3>
            </div>
            <div class="text-center mb-3" style="font-size: 0.75rem">
                (Beside Kolka CNG Pump, Shagorika, P.C Road, Chattogram.)
            </div>

            <div class="row px-3" style="text-align: left">
                <div class="col-md-6">
                    <div class="row ">
                        <div class="col-md-2">
                            <label for="Ref">Order No:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="number"
                                    class="form-control"
                                    id="order"
                                    name="order"
                                    value="{{ jobcard_records.order_id }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-2">
                            <label for="date">Date:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    class="form-control"
                                    id="date"
                                    value="{{ jobcard_records.order_date }}"
                            />
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-2">
                            <label for="name">Customer Name:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="name"
                                    name="name"
                                    value="{{ jobcard_records.customer_name }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-2">
                            <label for="address">Address:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="address"
                                    name="address"
                                    value="{{ jobcard_records.customer_address }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-2">
                            <label for="phone">Phone:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="phone"
                                    name="phone"
                                    value="{{ jobcard_records.customer_phone }}"
                            />
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <!-- Second column content here -->
                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label for="chassisNo">Chassis No:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="chassisNo"
                                    name="chassisNo"
                                    value="{{ jobcard_records.chassis }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label for="vehicleName">Vehicle Name:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="vehicleName"
                                    name="vehicleName"
                                    value="{{ jobcard_records.vehicle }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label for="modelYear">Model Year:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="modelYear"
                                    name="modelYear"
                                    value="{{ jobcard_records.model_year }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label for="model">Model:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="model"
                                    name="model"
                                    value="{{ jobcard_records.model }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label for="engineNo">Engine No:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="engineNo"
                                    name="engineNo"
                                    value="{{ jobcard_records.engine }}"
                            />
                        </div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-4">
                            <label for="vehicleReg">Vehicle Reg:</label>
                        </div>
                        <div class="col-md-8">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="vehicleReg"
                                    name="vehicleReg"
                                    value="{{ jobcard_records.reg }}"
                            />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div
                class="my-3 page-break-after"
                style="border: 1px solid black; "
        >
            <!-- Table -->
            <table class="table table-hover ">
                <thead>
                <tr>
                    <th scope="col">SL NO.</th>
                    <th scope="col">Customer request as per own words</th>
                    <th scope="col">Category</th>
                    <th scope="col">Labor Charge</th>
                    <!-- Empty column for delete button -->
                </tr>
                </thead>
                <tbody id="tableBody" class="px-3">
                <!-- Add table rows here -->
                {% for record in customer_records %}
                <tr>
                    <td>
                        <input
                                style="width: 100%; border: none"
                                type="text"
                                class="form-control text-center"
                                id="slno_{{ forloop.counter }}"
                                name="slno_{{ forloop.counter }}"
                                value="{{ record.sl_no }}"
                        />
                    </td>
                    <td>
                        <input
                                style="width: 100%; border: none"
                                type="text"
                                class="form-control"
                                id="customerRequest_{{ forloop.counter }}"
                                name="customerRequest_{{ forloop.counter }}"
                                value="{{ record.request }}"
                        />
                    </td>
                    <td>
                        <input
                                style="width: 100%; border: none"
                                type="text"
                                class="form-control"
                                id="category_{{ forloop.counter }}"
                                name="category_{{ forloop.counter }}"
                                value="{{ record.category }}"
                        />
                    </td>
                    <td>
                        <input
                                style="width: 100%; border: none"
                                type="text"
                                class="form-control laborCharge"
                                id="laborCharge_{{ forloop.counter }}"
                                name="laborCharge_{{ forloop.counter }}"
                                value="{{ record.charge }}"
                        />
                    </td>
                </tr>
                {% endfor %}
                <!-- Add more rows as needed -->
                </tbody>
            </table>
            <!-- Total -->
            <div class="row my-3">
                <div class="col-md-6">
                    <div class="d-flex">
                        <label style="margin-left: 100%">Total:</label>
                        <input
                                style="margin-left: 30%; width: 100px; border: none"
                                type="number"
                                class="form-control"
                                id="totalAmount"
                                name="totalAmount"
                                value="Amount"
                        />
                    </div>
                </div>
            </div>
        </div>

        <div
                class=""
                style="border: 1px solid black;"
        >
            <!-- Additional Table -->
            <div class="row page-break-before">
                <div class="col-md-12">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th scope="col">SL NO.</th>
                            <th scope="col">After Diagnosis and Inspection</th>
                        </tr>
                        </thead>
                        <tbody id="diagnosisTableBody" class="px-3">
                        {% for record in diagnosis_records %}
                        <tr>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control text-center"
                                        value="{{ record.sl_no }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        value="{{ record.diagnosis_detail }}"
                                />
                            </td>
                        </tr>
                        {% endfor %}
                        <!-- Add more rows as needed -->
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- Diagnosis By and Driver's/Owner's Signature -->
            <div class="row alias-ninja my-3">
                <div class="col-md-4 mt-5">
                    <!-- Horizontal line above Reference By -->
                    <hr
                            style="
                  border: 0;
                  border-top: 2px solid #000;
                  margin-top: 5px;
                  margin-bottom: 5px;
                  width: 100%;
                "
                    />
                    <div class="form-group" style="margin-left: 38%">
                        <label for="referenceBy">Reference By</label>
                    </div>
                </div>
                <div class="col-md-4 mt-5">
                    <!-- Horizontal line above Diagnosis By -->
                    <hr
                            style="
                  border: 0;
                  border-top: 2px solid #000;
                  margin-top: 5px;
                  margin-bottom: 5px;
                  width: 100%;
                "
                    />
                    <div class="form-group" style="margin-left: 38%">
                        <label for="diagnosisBy">Diagnosis By</label>
                    </div>
                </div>
                <div class="col-md-4 mt-5">
                    <!-- Horizontal line above Driver's/Owner's Signature -->
                    <hr
                            style="
                  border: 0;
                  border-top: 2px solid #000;
                  margin-top: 5px;
                  margin-bottom: 5px;
                  width: 100%;
                "
                    />
                    <div class="form-group">
                        <label for="signature" style="margin-left: 20%"
                        >Driver's/Owner's Signature</label
                        >
                    </div>
                </div>
            </div>
        </div>

        <div
                class="my-3"
                style="border: 1px solid black; "
        >
            <!-- Additional Table -->
            <div class="row  page-break-after">
                <div class="col-md-12">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th scope="col" class="text-center" colspan="4">
                                Issue From Store
                            </th>
                            <th scope="col" class="text-center" colspan="4">
                                Demand From WorkShop
                            </th>
                        </tr>
                        <tr>
                            <th scope="col">SL NO.</th>
                            <th scope="col">Description of Materials</th>
                            <th scope="col">Quantity</th>
                            <th scope="col">Price</th>
                            <th scope="col">Description of Requisition Materials</th>
                            <th scope="col">Quantity</th>
                            <th scope="col">Signature</th>
                        </tr>
                        </thead>
                        <tbody id="materialTableBody" class="px-3">
                        {% for record in issue_demand_records %}
                        <tr>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control text-center "
                                        id="mslno_1"
                                        name="mslno_1"
                                        value="{{ record.sl_no }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        id="mat_des_1"
                                        name="mat_des_1"
                                        value="{{ record.material_description }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        id="mat_qty_1"
                                        name="mat_qty_1"
                                        value="{{ record.material_qty }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        id="mat_price_1"
                                        name="mat_price_1"
                                        value="{{ record.material_price }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        id="req_des_1"
                                        name="req_des_1"
                                        value="{{ record.req_description }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        id="req_qty_1"
                                        name="req_qty_1"
                                        value="{{ record.req_qty }}"
                                />
                            </td>
                            <td>
                                <input
                                        style="width: 100%; border: none"
                                        type="text"
                                        class="form-control"
                                        id="mat_sign_1"
                                        name="mat_sign_1"
                                        value="{{ record.req_sign }}"
                                />
                            </td>
                        </tr>
                        {% endfor %}
                        <!-- Add more rows as needed -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row px-2 my-3">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="Ref">Engineer Name:</label>
                        <input
                                type="text"
                                class="form-control"
                                id="engineerName"
                                name="engineerName"
                                value="{{ issue_demand_engineer_records.engineer }}"
                        />
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="name">Technician Name:</label>
                        <input
                                type="text"
                                class="form-control"
                                id="technicianname"
                                name="technicianname"
                                value="{{ issue_demand_engineer_records.technician }}"
                        />
                    </div>
                </div>
            </div>
        </div>
        <br/>
    </form>
    <div class="text-center print-btn">
        <button class=" btn btn-login w-25 " onclick="window.print()">Print</button>
    </div>
</div>

{% include 'main/footer.html' %}
<!-- Bootstrap 5 JS (No jQuery required) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<!-- Your scripts -->
<script>
    // Get all the labor charge input elements
    const laborChargeInputs = document.querySelectorAll(".laborCharge");

    // Function to calculate and update the total amount
    function updateTotalAmount() {
      let totalAmount = 0;

      // Iterate over each labor charge input and sum the values
      laborChargeInputs.forEach((input) => {
        const laborCharge = parseFloat(input.value);
        if (!isNaN(laborCharge)) {
          totalAmount += laborCharge;
        }
      });

      // Update the total amount input field
      const totalAmountInput = document.getElementById("totalAmount");
      totalAmountInput.value = totalAmount.toFixed(2);
    }

    // Add event listeners to labor charge inputs for real-time updates
    laborChargeInputs.forEach((input) => {
      input.addEventListener("input", updateTotalAmount);
    });

    // Initial calculation on page load
    updateTotalAmount();
</script>
</body>
</html>
